<!DOCTYPE html>
<html>
  <head>
<style type='text/css'>
</style>
    <title>Ear training</title>
    <script src='jspsych-6.0.2/jspsych.js'></script>
    <script src='jspsych-6.0.2/plugins/jspsych-audio-button-response.js'></script>
    <script src='jspsych-6.0.2/plugins/jspsych-html-keyboard-response.js'></script>
    <script src='jspsych-6.0.2/plugins/jspsych-html-button-response.js'></script>
    <script src='jspsych-6.0.2/plugins/jspsych-fullscreen.js'></script>
    <link href='jspsych-6.0.2/css/jspsych.css' rel='stylesheet' type='text/css'></link>
    
  </head>
    <style>
    body {
    background-color: #000000;
    color: #D3D3D3
  </style>
  <body></body>
  <script>

    /* create timeline */
    var timeline = [];
timeline.push({
  type: 'fullscreen',
  fullscreen_mode: false
});
  
    var bemvindo = {
      type: 'html-button-response',
      stimulus: 'Pitch!',
      choices: ['Começar']
    };
    timeline.push(bemvindo);
       
    /* Treino em loop */

    var test_stimuli = [
          {son: 'sound/Tone500Hz_vs_Pitch500Hz_F0absent_maxF11_Entrained.wav', data: {test_part: 'test', correct_response: '1'}},      
          {son: 'sound/Tone500Hz_vs_Pitch500Hz_F0absent_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '1'}},     
          {son: 'sound/Tone500Hz_vs_Pitch500Hz_F0absent_maxF5_Entrained.wav' , data: {test_part: 'test', correct_response: '1'}},      
          {son: 'sound/Tone500Hz_vs_Pitch500Hz_F0included_maxF25_Dephased.wav' , data: {test_part: 'test', correct_response: '1'}},    
          {son: 'sound/Tone500Hz_vs_Pitch500Hz_F0included_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '1'}},   
          {son: 'sound/Tone500Hz_vs_Pitch501.25Hz_F0absent_maxF11_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},  
          {son: 'sound/Tone500Hz_vs_Pitch501.25Hz_F0absent_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},  
          {son: 'sound/Tone500Hz_vs_Pitch501.25Hz_F0absent_maxF5_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},   
          {son: 'sound/Tone500Hz_vs_Pitch501.25Hz_F0included_maxF25_Dephased.wav' , data: {test_part: 'test', correct_response: '0'}}, 
          {son: 'sound/Tone500Hz_vs_Pitch501.25Hz_F0included_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},
          {son: 'sound/Tone500Hz_vs_Pitch502.5Hz_F0absent_maxF11_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},   
          {son: 'sound/Tone500Hz_vs_Pitch502.5Hz_F0absent_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},   
          {son: 'sound/Tone500Hz_vs_Pitch502.5Hz_F0absent_maxF5_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},    
          {son: 'sound/Tone500Hz_vs_Pitch502.5Hz_F0included_maxF25_Dephased.wav' , data: {test_part: 'test', correct_response: '0'}},  
          {son: 'sound/Tone500Hz_vs_Pitch502.5Hz_F0included_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}}, 
          {son: 'sound/Tone500Hz_vs_Pitch505Hz_F0absent_maxF11_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch505Hz_F0absent_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch505Hz_F0absent_maxF5_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},      
          {son: 'sound/Tone500Hz_vs_Pitch505Hz_F0included_maxF25_Dephased.wav' , data: {test_part: 'test', correct_response: '0'}},    
          {son: 'sound/Tone500Hz_vs_Pitch505Hz_F0included_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},   
          {son: 'sound/Tone500Hz_vs_Pitch510Hz_F0absent_maxF11_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch510Hz_F0absent_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch510Hz_F0absent_maxF5_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},      
          {son: 'sound/Tone500Hz_vs_Pitch510Hz_F0included_maxF25_Dephased.wav' , data: {test_part: 'test', correct_response: '0'}},    
          {son: 'sound/Tone500Hz_vs_Pitch510Hz_F0included_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},   
          {son: 'sound/Tone500Hz_vs_Pitch520Hz_F0absent_maxF11_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch520Hz_F0absent_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch520Hz_F0absent_maxF5_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},      
          {son: 'sound/Tone500Hz_vs_Pitch520Hz_F0included_maxF25_Dephased.wav' , data: {test_part: 'test', correct_response: '0'}},    
          {son: 'sound/Tone500Hz_vs_Pitch520Hz_F0included_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},   
          {son: 'sound/Tone500Hz_vs_Pitch540Hz_F0absent_maxF11_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch540Hz_F0absent_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch540Hz_F0absent_maxF5_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},      
          {son: 'sound/Tone500Hz_vs_Pitch540Hz_F0included_maxF25_Dephased.wav' , data: {test_part: 'test', correct_response: '0'}},    
          {son: 'sound/Tone500Hz_vs_Pitch540Hz_F0included_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},   
          {son: 'sound/Tone500Hz_vs_Pitch580Hz_F0absent_maxF11_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch580Hz_F0absent_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},     
          {son: 'sound/Tone500Hz_vs_Pitch580Hz_F0absent_maxF5_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}},      
          {son: 'sound/Tone500Hz_vs_Pitch580Hz_F0included_maxF25_Dephased.wav' , data: {test_part: 'test', correct_response: '0'}},    
          {son: 'sound/Tone500Hz_vs_Pitch580Hz_F0included_maxF25_Entrained.wav' , data: {test_part: 'test', correct_response: '0'}}

];

  
    
    var test = {
      type: 'audio-button-response',
      stimulus: jsPsych.timelineVariable('son'),
      choices: jsPsych.NO_KEYS,
      prompt: '<p>Responda...</p>',
      choices: ['Igual', 'Diferente'],
      response_ends_trial: true,
      data: jsPsych.timelineVariable('data'),
      on_finish: function(data) {
            data.correct = data.button_pressed == data.correct_response;
    }
}

/*Treinando diferenciação*/
var feedback = {
        type: 'html-button-response',
        choices: ['Continuar'],
        stimulus: function() {
            var last_trial_correct = jsPsych.data.get().last(1).values()[0].correct;
            if (last_trial_correct) {
                return "<font size='5'>Certo!<br><br>Aperte enter para continuar</font>";
            } else {
                return "<font size='5'>Errado.<br><br>Aperte enter para tentar novamente</font>"
            }
        }
    }

    var test_procedure = {
      timeline: [test, feedback],
      timeline_variables: test_stimuli,
      repetitions: 1,
      randomize_order: true
        }
  
timeline.push(test_procedure);  





var acuracia = {
        type: 'html-keyboard-response',
        choices: [13],
        data: {
            primeiro_treino: 'primeiro_treino'
        },
        stimulus: function() {

            var trials = jsPsych.data.get().filter({
                test_part: 'test'
            });
            var correct_trials = trials.filter({
                correct: true
            });
            var accuracy = Math.round(correct_trials.count() / trials.count() * 100);

            return "<font size='5'>A sua taxa de acerto foi ' + accuracy + '%.<br><br>Precisa melhorar, hein...</font>";

        }
    }
timeline.push(acuracia);

    /* Treino em loop */

    var cabou = {
      type: 'html-keyboard-response',
      stimulus: 'Fim',
      post_trial_gap: 0,
      choices: ['spacebar']
    };
    timeline.push(cabou);
    
    /* start the experiment */

    jsPsych.init({
      timeline: timeline,
      preload_audio: [
            'sound/Tone500Hz_vs_Pitch500Hz_F0absent_maxF11_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch500Hz_F0absent_maxF25_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch500Hz_F0absent_maxF5_Entrained.wav',      
            'sound/Tone500Hz_vs_Pitch500Hz_F0included_maxF25_Dephased.wav',    
            'sound/Tone500Hz_vs_Pitch500Hz_F0included_maxF25_Entrained.wav',   
            'sound/Tone500Hz_vs_Pitch501.25Hz_F0absent_maxF11_Entrained.wav',  
            'sound/Tone500Hz_vs_Pitch501.25Hz_F0absent_maxF25_Entrained.wav',  
            'sound/Tone500Hz_vs_Pitch501.25Hz_F0absent_maxF5_Entrained.wav',   
            'sound/Tone500Hz_vs_Pitch501.25Hz_F0included_maxF25_Dephased.wav', 
            'sound/Tone500Hz_vs_Pitch501.25Hz_F0included_maxF25_Entrained.wav',
            'sound/Tone500Hz_vs_Pitch502.5Hz_F0absent_maxF11_Entrained.wav',   
            'sound/Tone500Hz_vs_Pitch502.5Hz_F0absent_maxF25_Entrained.wav',   
            'sound/Tone500Hz_vs_Pitch502.5Hz_F0absent_maxF5_Entrained.wav',    
            'sound/Tone500Hz_vs_Pitch502.5Hz_F0included_maxF25_Dephased.wav',  
            'sound/Tone500Hz_vs_Pitch502.5Hz_F0included_maxF25_Entrained.wav', 
            'sound/Tone500Hz_vs_Pitch505Hz_F0absent_maxF11_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch505Hz_F0absent_maxF25_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch505Hz_F0absent_maxF5_Entrained.wav',      
            'sound/Tone500Hz_vs_Pitch505Hz_F0included_maxF25_Dephased.wav',    
            'sound/Tone500Hz_vs_Pitch505Hz_F0included_maxF25_Entrained.wav',   
            'sound/Tone500Hz_vs_Pitch510Hz_F0absent_maxF11_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch510Hz_F0absent_maxF25_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch510Hz_F0absent_maxF5_Entrained.wav',      
            'sound/Tone500Hz_vs_Pitch510Hz_F0included_maxF25_Dephased.wav',    
            'sound/Tone500Hz_vs_Pitch510Hz_F0included_maxF25_Entrained.wav',   
            'sound/Tone500Hz_vs_Pitch520Hz_F0absent_maxF11_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch520Hz_F0absent_maxF25_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch520Hz_F0absent_maxF5_Entrained.wav',      
            'sound/Tone500Hz_vs_Pitch520Hz_F0included_maxF25_Dephased.wav',    
            'sound/Tone500Hz_vs_Pitch520Hz_F0included_maxF25_Entrained.wav',   
            'sound/Tone500Hz_vs_Pitch540Hz_F0absent_maxF11_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch540Hz_F0absent_maxF25_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch540Hz_F0absent_maxF5_Entrained.wav',      
            'sound/Tone500Hz_vs_Pitch540Hz_F0included_maxF25_Dephased.wav',    
            'sound/Tone500Hz_vs_Pitch540Hz_F0included_maxF25_Entrained.wav',   
            'sound/Tone500Hz_vs_Pitch580Hz_F0absent_maxF11_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch580Hz_F0absent_maxF25_Entrained.wav',     
            'sound/Tone500Hz_vs_Pitch580Hz_F0absent_maxF5_Entrained.wav',      
            'sound/Tone500Hz_vs_Pitch580Hz_F0included_maxF25_Dephased.wav',    
            'sound/Tone500Hz_vs_Pitch580Hz_F0included_maxF25_Entrained.wav' 
],
     
      on_finish: function(data) {
      var resultJson = jsPsych.data.get().filter([{trial_type: 'survey-text'}, {trial_type: 'html-button-response'}, {trial_type: 'audio-keyboard-response'}]).json();
      }
    });
  </script>
</html>

